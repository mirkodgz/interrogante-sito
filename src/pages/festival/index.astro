---
import Layout from "../../layouts/Layout.astro";
import SectionHeader from "../../components/ui/SectionHeader";
import { getCollection } from "astro:content";

// 1. Obtener todas las ediciones del festival
const festivales = await getCollection("festival");

// 2. Ordenarlas por fecha (de la más reciente a la más antigua)
const festivalesOrdenados = festivales.sort(
    (a, b) => b.data.date.valueOf() - a.data.date.valueOf(),
);
---

<Layout title="Festival A PIEDI NUDI">
    <main class="min-h-screen bg-white">
        {/* Header de la sección */}
        <div class="pt-32 pb-12 px-4 max-w-7xl mx-auto">
            <SectionHeader
                title="Nuestro Festival"
                highlightedWord="Festival"
                description="Explora la trayectoria del festival A PIEDI NUDI a través de sus ediciones."
                className="mb-16"
                client:load
            />

            {/* Grid de Festivales */}
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                {
                    festivalesOrdenados.map((edicion) => (
                        <article class="group relative flex flex-col gap-4">
                            {/* Imagen con efecto hover */}
                            <div class="overflow-hidden rounded-lg aspect-[4/3] bg-gray-100">
                                <img
                                    src={edicion.data.cover}
                                    alt={edicion.data.title}
                                    class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                                />
                            </div>

                            {/* Contenido */}
                            <div class="space-y-2">
                                <span class="text-sm font-nav tracking-widest text-primary uppercase">
                                    {edicion.data.edition} •{" "}
                                    {edicion.data.date.getFullYear()}
                                </span>
                                <h2 class="text-3xl font-primary text-black group-hover:text-primary transition-colors">
                                    {edicion.data.title}
                                </h2>
                                <p class="text-black/60 font-sans line-clamp-3">
                                    {edicion.data.description}
                                </p>

                                {/* Link simulado (pronto haremos la página de detalle individual) */}
                                <div class="pt-2">
                                    <span class="text-black font-nav text-sm border-b border-black pb-0.5 group-hover:text-primary group-hover:border-primary transition-colors">
                                        VER MÁS
                                    </span>
                                </div>
                            </div>
                        </article>
                    ))
                }
            </div>
        </div>
    </main>
</Layout>
